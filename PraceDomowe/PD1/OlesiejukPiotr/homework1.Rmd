---
title: "R Notebook"
output: html_notebook
---

# Wykresy

Dla poszczególnych typów wykresów, kolejne wykresy s¹ prezentowane w kolejnoœci: ggplot2, lattice oraz graphics. W przypadku wykresu piechart zerowy czas dla pakietu lattice wynika z braku mo¿liwoœci narysowania wykresu piechart z wykorzystaniem tego pakietu. Przy pomiarze czasów, wykresy z pakietów ggplot2 oraz lattice by³y dodatkowo wyœwietlana funkcj¹ print, gdy¿ w pakiecie graphics wyœwietlanie jest wbudowane w funcje rysuj¹ce wykresy.

```{r}
library(lattice)
library(ggplot2)
library(graphics)
library(magrittr)
library(dplyr)
```

## Barplot


```{r}
df <- USArrests[order(USArrests$Murder, decreasing = TRUE)[1:10], 1]
df <- data.frame(States = rownames(USArrests)[1:10], Murders = df)
#ggplot2
ggplot(df, aes(x = States, y = Murders)) + geom_col()

#lattice
barchart(Murders ~ States, data = df)

#graphics
barplot(df$Murders, names.arg = df$States)
```

## Scatterplot

```{r}
df <- iris

#ggplot2
ggplot(data = df, aes(Sepal.Length, Sepal.Width)) + geom_point()

#lattice
xyplot(Sepal.Width ~ Sepal.Length, data = df)

#graphics
plot(df$Sepal.Length, df$Sepal.Width)

```


## Boxplot

```{r}
df <- datasets::PlantGrowth

#ggplot2
ggplot(data = df, aes(x = group, y = weight)) + geom_boxplot()

#lattice
bwplot(weight ~ group, data = df)

#graphics
boxplot(weight ~ group, data = df)

```

## Piechart

```{r}
df <- as.data.frame(datasets::Titanic)
df <- df %>% group_by(Class) %>% summarise(People =sum(Freq)) %>% data.frame

#ggplot2
ggplot(dat = df, aes(x = "", y = People,fill = Class)) + geom_bar(width = 1, stat = 'identity') +
    coord_polar(theta = 'y', start = 0)
#graphics
pie(x = df$People, labels = df$Class)

# no pie chart in lattice
```

## Facets


```{r, results = 'hide'}
#ggplot2
ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) + geom_point() +
    facet_wrap(~Species)

#lattice
xyplot(Sepal.Width ~ Sepal.Length | Species, data = iris)

#graphics
df <- split(iris, iris$Species)
par(mfrow = c(2,2))
lapply(df, function(d) plot(Sepal.Width ~ Sepal.Length, data = d))
```


## Performance

Najszybszym sposobem by narysowaæ wykres jest wykorzystanie pakietu graphics. Co ciekawe, zwiêkszone czasy dla pakietów ggplot2 oraz lattice wynikaj¹ ze stosunkowo d³ugiego wykonywania funkcji print. Sama konstrukcja obiektów wykresów jest natomiast zdecydowanie szybsza dla tych pakietów. W przypadku kiedy dopiero pewna ostateczna postaæ wykresu musi byæ wyœwietlona na ekranie koszt czasowy ggplot2 i lattice jest znikomy.

```{r echo = FALSE, results='hide', include = FALSE}
source("./homework1.R")
```

```{r, echo = FALSE}
ggplot(data = results, aes(x = Package, y = Time, fill = Package)) + geom_col() + 
  facet_wrap(~Plot) +
  ggtitle("Execution time in miliseconds") +
  theme_fivethirtyeight() + 
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none",
        plot.background = element_blank())
```
